generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model SiteSettings {
  id                       Int      @id @default(autoincrement())
  logoUrl                  String?
  logoLightUrl             String?
  logoDarkUrl              String?
  faviconUrl               String?
  faviconLightUrl          String?
  faviconDarkUrl           String?
  smtpEnabled              Boolean  @default(false)
  smtpHost                 String?
  smtpPort                 Int?     @default(587)
  smtpSecure               Boolean  @default(true)
  smtpUsername             String?
  smtpPassword             String?
  smtpFromEmail            String?
  smtpFromName             String?
  smtpReplyTo              String?
  emailSignature           String?
  emailFooterText          String?
  emailBrandingEnabled     Boolean  @default(true)
  adminNotificationEmail   String?
  emailLoggingEnabled      Boolean  @default(true)
  emailRateLimitPerHour    Int?     @default(100)
  companyPhone             String?
  companyEmail             String?
  companyAddress           String?
  socialFacebook           String?
  socialTwitter            String?
  socialLinkedin           String?
  socialInstagram          String?
  socialYoutube            String?
  footerNewsletterFormId   Int?
  footerCopyrightMessage   String?
  footerMenuIds            String?
  footerShowContactInfo    Boolean  @default(true)
  footerShowSocialLinks    Boolean  @default(true)
  footerCompanyName        String?
  footerCompanyDescription String?
  footerBackgroundColor    String?  @default("#F9FAFB")
  footerTextColor          String?  @default("#374151")
  baseUrl                  String?  @default("")
  createdAt                DateTime @default(now())
  updatedAt                DateTime @updatedAt
  gaMeasurementId          String?  @default("NULL")
  gtmContainerId           String?  @default("NULL")
  gtmEnabled               Boolean  @default(false)
  cloudinaryApiKey         String?
  cloudinaryApiSecret      String?
  cloudinaryCloudName      String?
  cloudinaryEnabled        Boolean  @default(false)
  cloudinaryUploadPreset   String?
  sidebarBackgroundColor   String?  @default("#1F2937")
  sidebarHoverColor        String?  @default("#D1D5DB")
  sidebarSelectedColor     String?  @default("#FFFFFF")
  sidebarTextColor         String?  @default("#E5E7EB")

  @@map("site_settings")
}

model ServiceAccountCredentials {
  id                      Int      @id @default(autoincrement())
  projectId               String
  clientEmail             String
  privateKey              String
  privateKeyId            String
  clientId                String
  authUri                 String
  tokenUri                String
  authProviderX509CertUrl String
  clientX509CertUrl       String
  universeDomain          String
  isActive                Boolean  @default(true)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @default(now()) @updatedAt

  @@map("service_account_credentials")
}

model SitemapSubmissionLog {
  id             String   @id @default(cuid())
  sitemapUrl     String
  siteUrl        String
  submittedAt    DateTime @default(now())
  status         String
  searchEngine   String
  googleResponse String?
  errorMessage   String?
  statusCode     Int?
  submissionId   String?
  warnings       String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now()) @updatedAt

  @@map("sitemap_submission_logs")
}

model DesignSystem {
  id                  Int      @id @default(autoincrement())
  primaryColor        String   @default("#5243E9")
  primaryColorLight   String   @default("#6366F1")
  primaryColorDark    String   @default("#4338CA")
  secondaryColor      String   @default("#7C3AED")
  accentColor         String   @default("#06B6D4")
  successColor        String   @default("#10B981")
  warningColor        String   @default("#F59E0B")
  errorColor          String   @default("#EF4444")
  infoColor           String   @default("#3B82F6")
  grayLight           String   @default("#F9FAFB")
  grayMedium          String   @default("#6B7280")
  grayDark            String   @default("#374151")
  backgroundPrimary   String   @default("#FFFFFF")
  backgroundSecondary String   @default("#F6F8FC")
  backgroundDark      String   @default("#0F1A2A")
  textPrimary         String   @default("#1F2937")
  textSecondary       String   @default("#6B7280")
  textMuted           String   @default("#9CA3AF")
  fontFamily          String   @default("Manrope")
  fontFamilyMono      String   @default("ui-monospace")
  fontSizeBase        String   @default("16px")
  lineHeightBase      String   @default("1.5")
  fontWeightNormal    String   @default("400")
  fontWeightMedium    String   @default("500")
  fontWeightBold      String   @default("700")
  spacingXs           String   @default("4px")
  spacingSm           String   @default("8px")
  spacingMd           String   @default("16px")
  spacingLg           String   @default("24px")
  spacingXl           String   @default("32px")
  spacing2xl          String   @default("48px")
  borderRadiusSm      String   @default("4px")
  borderRadiusMd      String   @default("8px")
  borderRadiusLg      String   @default("12px")
  borderRadiusXl      String   @default("16px")
  borderRadiusFull    String   @default("9999px")
  shadowSm            String   @default("0 1px 2px 0 rgb(0 0 0 / 0.05)")
  shadowMd            String   @default("0 4px 6px -1px rgb(0 0 0 / 0.1)")
  shadowLg            String   @default("0 10px 15px -3px rgb(0 0 0 / 0.1)")
  shadowXl            String   @default("0 20px 25px -5px rgb(0 0 0 / 0.1)")
  animationFast       String   @default("150ms")
  animationNormal     String   @default("300ms")
  animationSlow       String   @default("500ms")
  breakpointSm        String   @default("640px")
  breakpointMd        String   @default("768px")
  breakpointLg        String   @default("1024px")
  breakpointXl        String   @default("1280px")
  breakpoint2xl       String   @default("1536px")
  themeMode           String   @default("light")
  customVariables     String?
  isActive            Boolean  @default(true)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  @@map("design_system")
}

model MediaLibrary {
  id           Int          @id @default(autoincrement())
  filename     String
  title        String?
  description  String?
  alt          String?
  fileType     String
  mimeType     String
  fileSize     Int
  width        Int?
  height       Int?
  duration     Float?
  originalUrl  String
  localPath    String?
  publicUrl    String
  thumbnailUrl String?
  folderId     Int?
  tags         String?
  uploadSource String       @default("upload")
  uploadedBy   String?
  isActive     Boolean      @default(true)
  isPublic     Boolean      @default(true)
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  folder       MediaFolder? @relation(fields: [folderId], references: [id])
  usages       MediaUsage[]

  @@map("media_library")
}

model MediaFolder {
  id          Int            @id @default(autoincrement())
  name        String
  description String?
  parentId    Int?
  color       String         @default("#5243E9")
  sortOrder   Int            @default(0)
  isActive    Boolean        @default(true)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  parent      MediaFolder?   @relation("FolderHierarchy", fields: [parentId], references: [id])
  children    MediaFolder[]  @relation("FolderHierarchy")
  media       MediaLibrary[]

  @@map("media_folders")
}

model MediaUsage {
  id         Int          @id @default(autoincrement())
  mediaId    Int
  entityType String
  entityId   Int
  fieldName  String
  createdAt  DateTime     @default(now())
  media      MediaLibrary @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  @@unique([mediaId, entityType, entityId, fieldName])
  @@map("media_usage")
}

model AdminUser {
  id           Int       @id @default(autoincrement())
  username     String    @unique
  email        String    @unique
  passwordHash String
  name         String?
  role         String    @default("admin")
  isActive     Boolean   @default(true)
  lastLoginAt  DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@map("admin_users")
}

model Client {
  id           Int       @id @default(autoincrement())
  name         String
  officeAddress String?
  phone        String?
  email        String?
  isActive     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  projects     Project[] // One client can have many projects

  @@map("clients")
}

model Consultant {
  id           Int       @id @default(autoincrement())
  name         String
  officeAddress String?
  phone        String?
  email        String?
  isActive     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  types        ConsultantType[] // Many-to-many with consultant types
  projectsAsPMC Project[] @relation("ProjectManagementConsultant")
  projectsAsDesign Project[] @relation("DesignConsultant")
  projectsAsCost Project[] @relation("CostConsultant")
  projectsAsSupervision Project[] @relation("SupervisionConsultant")

  @@map("consultants")
}

model ConsultantType {
  id          Int         @id @default(autoincrement())
  type        String      @unique // "PMC", "Design", "Cost", "Supervision"
  description String?
  consultants Consultant[]
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@map("consultant_types")
}

model CompanyStaff {
  id        Int      @id @default(autoincrement())
  staffName String
  email     String?
  phone     String?
  position  String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  projectsAsDirector Project[] @relation("ProjectDirector") // Staff can be project director on multiple projects
  projectsAsManager  Project[] @relation("ProjectManager") // Staff can be project manager on multiple projects

  @@map("company_staff")
}

model Contact {
  id          Int       @id @default(autoincrement())
  firstName   String
  lastName    String
  email       String?
  phone       String?
  position    String?
  notes       String?
  isActive    Boolean   @default(true)
  entityType  String    // 'client' or 'consultant'
  entityId    Int       // ID of the client or consultant
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  projectContacts ProjectContact[] // Many-to-many with projects

  @@map("contacts")
}

model ProjectContact {
  id          Int       @id @default(autoincrement())
  projectId   Int
  contactId   Int
  isPrimary   Boolean   @default(false) // Primary contact for this specific project
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  project     Project   @relation(fields: [projectId], references: [id], onDelete: Cascade)
  contact     Contact   @relation(fields: [contactId], references: [id], onDelete: Cascade)
  
  @@unique([projectId, contactId]) // Prevent duplicate project-contact relationships
  @@map("project_contacts")
}

model Project {
  id                        Int       @id @default(autoincrement())
  projectCode              String    @unique // Unique project code
  projectName              String
  projectDescription       String?
  clientId                 Int?      // FK to Client
  client                   Client?   @relation(fields: [clientId], references: [id])
  projectManagementConsultantId Int? // FK to Consultant
  projectManagementConsultant Consultant? @relation("ProjectManagementConsultant", fields: [projectManagementConsultantId], references: [id])
  designConsultantId       Int?      // FK to Consultant
  designConsultant         Consultant? @relation("DesignConsultant", fields: [designConsultantId], references: [id])
  supervisionConsultantId  Int?      // FK to Consultant
  supervisionConsultant    Consultant? @relation("SupervisionConsultant", fields: [supervisionConsultantId], references: [id])
  costConsultantId         Int?      // FK to Consultant
  costConsultant           Consultant? @relation("CostConsultant", fields: [costConsultantId], references: [id])
  projectDirectorId        Int?      // FK to CompanyStaff
  projectDirector          CompanyStaff? @relation("ProjectDirector", fields: [projectDirectorId], references: [id])
  projectManagerId         Int?      // FK to CompanyStaff
  projectManager           CompanyStaff? @relation("ProjectManager", fields: [projectManagerId], references: [id])
  startDate                DateTime?
  endDate                  DateTime?
  duration                 String?   // Duration in a readable format (e.g., "6 months", "2 years")
  eot                      String?   // Extension of Time
  lastUpdate               DateTime  @default(now()) @updatedAt
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt
  projectContacts          ProjectContact[] // Many-to-many with contacts

  @@map("projects")
}
