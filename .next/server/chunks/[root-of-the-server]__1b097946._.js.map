{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma; "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/validations.ts"],"sourcesContent":["import { z } from 'zod';\n\n// Common validations\nexport const IdSchema = z.number().int().positive();\nexport const SlugSchema = z.string().min(1).max(100).regex(/^[a-zA-Z0-9-_]+$/, 'Invalid slug format');\nexport const UrlSchema = z.string().url('Invalid URL format');\n\n// Helper for optional string fields that can be empty\nconst optionalString = z.string().optional().nullable().transform(val => val === '' ? null : val);\nconst optionalUrl = z.string().optional().nullable().transform(val => val === '' ? null : val).refine(val => {\n  if (val === null || val === undefined) return true;\n  // Allow data URIs for base64 encoded images\n  if (val.startsWith('data:')) return true;\n  // Allow relative paths (starting with /)\n  if (val.startsWith('/')) return true;\n  // Allow regular URLs\n  return z.string().url().safeParse(val).success;\n}, { message: \"Invalid URL format\" });\nconst optionalEmail = z.string().optional().nullable().transform(val => val === '' ? null : val).refine(val => {\n  if (val === null || val === undefined) return true;\n  return z.string().email().safeParse(val).success;\n}, { message: \"Invalid email format\" });\n\n// Site Settings Schema\nexport const SiteSettingsSchema = z.object({\n  logoUrl: optionalUrl,\n  logoLightUrl: optionalUrl,\n  logoDarkUrl: optionalUrl,\n  faviconUrl: optionalUrl,\n  faviconLightUrl: optionalUrl,\n  faviconDarkUrl: optionalUrl,\n  \n  // Email Configuration\n  smtpEnabled: z.boolean().optional(),\n  smtpHost: optionalString,\n  smtpPort: z.number().int().min(1).max(65535).optional().nullable(),\n  smtpSecure: z.boolean().optional(),\n  smtpUsername: optionalString,\n  smtpPassword: optionalString,\n  smtpFromEmail: optionalEmail,\n  smtpFromName: optionalString,\n  smtpReplyTo: optionalEmail,\n  \n  // Email Templates Configuration\n  emailSignature: optionalString,\n  emailFooterText: optionalString,\n  emailBrandingEnabled: z.boolean().optional(),\n  \n  // Email Notification Settings\n  adminNotificationEmail: optionalEmail,\n  emailLoggingEnabled: z.boolean().optional(),\n  emailRateLimitPerHour: z.number().int().min(1).max(1000).optional().nullable(),\n  \n  // Social Media Links\n  socialFacebook: optionalUrl,\n  socialTwitter: optionalUrl,\n  socialLinkedin: optionalUrl,\n  socialInstagram: optionalUrl,\n  socialYoutube: optionalUrl,\n  \n  // Contact Information\n  companyPhone: optionalString,\n  companyEmail: optionalEmail,\n  companyAddress: optionalString,\n  \n  // Footer Settings\n  footerCompanyName: optionalString,\n  footerCompanyDescription: optionalString,\n  footerNewsletterFormId: z.number().int().positive().optional().nullable(),\n  footerCopyrightMessage: optionalString,\n  footerMenuIds: optionalString,\n  footerShowContactInfo: z.boolean().optional(),\n  footerShowSocialLinks: z.boolean().optional(),\n  footerBackgroundColor: optionalString,\n  footerTextColor: optionalString,\n  \n  // SEO & Analytics\n  baseUrl: optionalUrl,\n  gaMeasurementId: optionalString,\n  gtmContainerId: optionalString,\n  gtmEnabled: z.boolean().optional(),\n  \n  // Cloudinary Configuration\n  cloudinaryCloudName: optionalString,\n  cloudinaryApiKey: optionalString,\n  cloudinaryApiSecret: optionalString,\n  cloudinaryUploadPreset: optionalString,\n  cloudinaryEnabled: z.boolean().optional(),\n  \n  // Sidebar Configuration\n  sidebarBackgroundColor: optionalString,\n  sidebarTextColor: optionalString,\n  sidebarSelectedColor: optionalString,\n  sidebarHoverColor: optionalString,\n});\n\nexport const SiteSettingsUpdateSchema = SiteSettingsSchema.partial();\n\n// API Response Type\nexport const ApiResponseSchema = z.object({\n  success: z.boolean(),\n  data: z.unknown().optional(),\n  message: z.string().optional(),\n  error: z.string().optional(),\n});\n\nexport type ApiResponse<T = unknown> = {\n  success: boolean;\n  data?: T;\n  message?: string;\n  error?: string;\n};\n\n// Validation helper function\nexport function validateAndTransform<T>(schema: z.ZodSchema<T>, data: unknown): T {\n  return schema.parse(data);\n}\n\n// Media Library Schemas\nexport const CreateMediaLibrarySchema = z.object({\n  filename: z.string().min(1).max(255),\n  title: optionalString,\n  description: optionalString,\n  alt: optionalString,\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']),\n  mimeType: z.string().min(1).max(100),\n  fileSize: z.number().int().positive(),\n  width: z.number().int().positive().optional().nullable(),\n  height: z.number().int().positive().optional().nullable(),\n  duration: z.number().positive().optional().nullable(),\n  originalUrl: z.string().url(),\n  localPath: optionalString,\n  publicUrl: z.string().url(),\n  thumbnailUrl: optionalUrl,\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: optionalString,\n  uploadSource: z.enum(['upload', 'url', 'cloudinary']).optional(),\n  uploadedBy: optionalString,\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n});\n\nexport const UpdateMediaLibrarySchema = z.object({\n  id: z.number().int().positive(),\n  filename: z.string().min(1).max(255).optional(),\n  title: optionalString,\n  description: optionalString,\n  alt: optionalString,\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']).optional(),\n  mimeType: z.string().min(1).max(100).optional(),\n  fileSize: z.number().int().positive().optional(),\n  width: z.number().int().positive().optional().nullable(),\n  height: z.number().int().positive().optional().nullable(),\n  duration: z.number().positive().optional().nullable(),\n  originalUrl: z.string().url().optional(),\n  localPath: optionalString,\n  publicUrl: z.string().url().optional(),\n  thumbnailUrl: optionalUrl,\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: optionalString,\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n});\n\n// Media Folder Schemas\nexport const CreateMediaFolderSchema = z.object({\n  name: z.string().min(1).max(100),\n  description: optionalString,\n  parentId: z.number().int().positive().optional().nullable(),\n  color: z.string().regex(/^#[0-9A-Fa-f]{6}$/, 'Invalid hex color').optional(),\n  sortOrder: z.number().int().optional(),\n  isActive: z.boolean().optional(),\n});\n\nexport const UpdateMediaFolderSchema = z.object({\n  id: z.number().int().positive(),\n  name: z.string().min(1).max(100).optional(),\n  description: optionalString,\n  parentId: z.number().int().positive().optional().nullable(),\n  color: z.string().regex(/^#[0-9A-Fa-f]{6}$/, 'Invalid hex color').optional(),\n  sortOrder: z.number().int().optional(),\n  isActive: z.boolean().optional(),\n});\n\n// Media Usage Schema\nexport const CreateMediaUsageSchema = z.object({\n  mediaId: z.number().int().positive(),\n  entityType: z.string().min(1).max(50),\n  entityId: z.number().int().positive(),\n  fieldName: z.string().min(1).max(100),\n});\n\n// Media Upload/Import Schemas\nexport const MediaUploadSchema = z.object({\n  file: z.instanceof(File),\n  folderId: z.number().int().positive().optional().nullable(),\n  title: optionalString,\n  alt: optionalString,\n  description: optionalString,\n});\n\nexport const MediaUrlImportSchema = z.object({\n  url: z.string().url(),\n  folderId: z.number().int().positive().optional().nullable(),\n  title: optionalString,\n  alt: optionalString,\n  description: optionalString,\n  tags: z.array(z.string()).optional(),\n});\n\n// Media Search Schema\nexport const MediaSearchSchema = z.object({\n  query: z.string().optional(),\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']).optional(),\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: z.array(z.string()).optional(),\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n  sortBy: z.enum(['createdAt', 'updatedAt', 'filename', 'fileSize']).optional(),\n  sortOrder: z.enum(['asc', 'desc']).optional(),\n  page: z.number().int().min(1).optional(),\n  limit: z.number().int().min(1).max(100).optional(),\n  offset: z.number().int().min(0).optional(),\n});\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/app/api/admin/site-settings/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { prisma } from '@/lib/db';\nimport { z } from 'zod';\nimport { SiteSettingsSchema, SiteSettingsUpdateSchema } from '@/lib/validations';\n\n// GET - Retrieve current site settings\nexport async function GET() {\n  try {\n    let siteSettings = await prisma.siteSettings.findFirst();\n    \n    // Create default settings if none exist\n    if (!siteSettings) {\n      siteSettings = await prisma.siteSettings.create({\n        data: {\n          smtpEnabled: false,\n          smtpPort: 587,\n          smtpSecure: true,\n          emailBrandingEnabled: true,\n          emailLoggingEnabled: true,\n          emailRateLimitPerHour: 100,\n        },\n      });\n    }\n\n    // Remove sensitive data before sending to client\n    const { smtpPassword, ...safeSiteSettings } = siteSettings;\n\n    const response = NextResponse.json({\n      success: true,\n      data: safeSiteSettings\n    });\n    \n    // Add cache-busting headers\n    response.headers.set('Cache-Control', 'no-cache, no-store, must-revalidate');\n    response.headers.set('Pragma', 'no-cache');\n    response.headers.set('Expires', '0');\n    \n    return response;\n  } catch (error) {\n    console.error('Error fetching site settings:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch site settings' },\n      { status: 500 }\n    );\n  }\n}\n\n// POST - Create or update site settings\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { \n      logoUrl, \n      faviconUrl, \n      faviconLightUrl, \n      faviconDarkUrl, \n      baseUrl,\n      cloudinaryEnabled,\n      cloudinaryCloudName,\n      cloudinaryApiKey,\n      cloudinaryApiSecret,\n      sidebarBackgroundColor,\n      sidebarTextColor,\n      sidebarSelectedColor,\n      sidebarHoverColor\n    } = body;\n\n    // Check if settings already exist\n    const existingSettings = await prisma.siteSettings.findFirst();\n\n    let settings;\n    if (existingSettings) {\n      // Update existing settings\n      settings = await prisma.siteSettings.update({\n        where: { id: existingSettings.id },\n        data: {\n          logoUrl: logoUrl || existingSettings.logoUrl,\n          faviconUrl: faviconUrl || existingSettings.faviconUrl,\n          faviconLightUrl: faviconLightUrl || existingSettings.faviconLightUrl,\n          faviconDarkUrl: faviconDarkUrl || existingSettings.faviconDarkUrl,\n          baseUrl: baseUrl !== undefined ? baseUrl : existingSettings.baseUrl,\n          cloudinaryEnabled: cloudinaryEnabled !== undefined ? cloudinaryEnabled : existingSettings.cloudinaryEnabled,\n          cloudinaryCloudName: cloudinaryCloudName !== undefined ? cloudinaryCloudName : existingSettings.cloudinaryCloudName,\n          cloudinaryApiKey: cloudinaryApiKey !== undefined ? cloudinaryApiKey : existingSettings.cloudinaryApiKey,\n          cloudinaryApiSecret: cloudinaryApiSecret !== undefined ? cloudinaryApiSecret : existingSettings.cloudinaryApiSecret,\n          sidebarBackgroundColor: sidebarBackgroundColor !== undefined ? sidebarBackgroundColor : existingSettings.sidebarBackgroundColor,\n          sidebarTextColor: sidebarTextColor !== undefined ? sidebarTextColor : existingSettings.sidebarTextColor,\n          sidebarSelectedColor: sidebarSelectedColor !== undefined ? sidebarSelectedColor : existingSettings.sidebarSelectedColor,\n          sidebarHoverColor: sidebarHoverColor !== undefined ? sidebarHoverColor : existingSettings.sidebarHoverColor,\n        }\n      });\n    } else {\n      // Create new settings\n      settings = await prisma.siteSettings.create({\n        data: {\n          logoUrl,\n          faviconUrl,\n          faviconLightUrl,\n          faviconDarkUrl,\n          baseUrl: baseUrl || '',\n          cloudinaryEnabled: cloudinaryEnabled || false,\n          cloudinaryCloudName: cloudinaryCloudName || null,\n          cloudinaryApiKey: cloudinaryApiKey || null,\n          cloudinaryApiSecret: cloudinaryApiSecret || null,\n          sidebarBackgroundColor: sidebarBackgroundColor || '#1F2937',\n          sidebarTextColor: sidebarTextColor || '#E5E7EB',\n          sidebarSelectedColor: sidebarSelectedColor || '#FFFFFF',\n          sidebarHoverColor: sidebarHoverColor || '#D1D5DB',\n          smtpEnabled: false,\n          smtpPort: 587,\n          smtpSecure: true,\n          emailBrandingEnabled: true,\n          emailLoggingEnabled: true,\n          emailRateLimitPerHour: 100,\n        }\n      });\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: settings,\n      message: 'Site settings updated successfully'\n    });\n  } catch (error) {\n    console.error('Error updating site settings:', error);\n    return NextResponse.json(\n      { success: false, message: 'Failed to update site settings' },\n      { status: 500 }\n    );\n  }\n}\n\n// PUT - Update specific field\nexport async function PUT(request: NextRequest) {\n  try {\n    const body = await request.json();\n    console.log('PUT /api/admin/site-settings - Request body:', body);\n    \n    // Validate the request body for partial updates\n    const validatedData = SiteSettingsUpdateSchema.parse(body);\n    console.log('PUT /api/admin/site-settings - Validated data:', validatedData);\n\n    // Get existing settings or create if none exist\n    let existingSettings = await prisma.siteSettings.findFirst();\n    \n    if (!existingSettings) {\n      // Create new settings\n      const newSettings = await prisma.siteSettings.create({\n        data: {\n          ...validatedData,\n          smtpEnabled: validatedData.smtpEnabled ?? false,\n          smtpPort: validatedData.smtpPort ?? 587,\n          smtpSecure: validatedData.smtpSecure ?? true,\n          emailBrandingEnabled: validatedData.emailBrandingEnabled ?? true,\n          emailLoggingEnabled: validatedData.emailLoggingEnabled ?? true,\n          emailRateLimitPerHour: validatedData.emailRateLimitPerHour ?? 100,\n        },\n      });\n\n      const { smtpPassword, ...safeSiteSettings } = newSettings;\n      return NextResponse.json({\n        success: true,\n        data: safeSiteSettings,\n        message: 'Site settings created successfully'\n      });\n    } else {\n      // Update existing settings\n      const updatedSettings = await prisma.siteSettings.update({\n        where: { id: existingSettings.id },\n        data: validatedData,\n      });\n\n      const { smtpPassword, ...safeSiteSettings } = updatedSettings;\n      return NextResponse.json({\n        success: true,\n        data: safeSiteSettings,\n        message: 'Site settings updated successfully'\n      });\n    }\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      console.error('Validation error:', error.errors);\n      return NextResponse.json(\n        { success: false, error: 'Validation failed', details: error.errors },\n        { status: 400 }\n      );\n    }\n    \n    console.error('Error updating site settings:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to update site settings' },\n      { status: 500 }\n    );\n  }\n} "],"names":[],"mappings":"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","debugId":null}}]
}