{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma; "],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/app/api/admin/project-staff/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { prisma } from '@/lib/db';\nimport { z } from 'zod';\n\n// Schema for updating project staff assignment\nconst updateProjectStaffSchema = z.object({\n  staffId: z.number().int().positive().nullable().optional(),\n  utilization: z.number().int().min(0).optional(), // Staff utilization percentage\n  startDate: z.string().optional().nullable().or(z.literal('')),\n  endDate: z.string().optional().nullable().or(z.literal('')),\n  status: z.string().optional(),\n  notes: z.string().optional().nullable().or(z.literal('')),\n});\n\n// GET - Fetch specific project staff assignment\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: { id: string } }\n) {\n  try {\n    const projectStaffId = parseInt(params.id);\n\n    const projectStaff = await prisma.projectStaff.findUnique({\n      where: { id: projectStaffId },\n      include: {\n        staff: true,\n        position: true,\n        project: {\n          select: {\n            id: true,\n            projectName: true,\n            projectCode: true,\n          },\n        },\n      },\n    });\n\n    if (!projectStaff) {\n      return NextResponse.json(\n        { success: false, error: 'Project staff assignment not found' },\n        { status: 404 }\n      );\n    }\n\n    return NextResponse.json({\n      success: true,\n      data: projectStaff,\n      message: 'Project staff assignment retrieved successfully',\n    });\n  } catch (error) {\n    console.error('Error fetching project staff assignment:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch project staff assignment' },\n      { status: 500 }\n    );\n  }\n}\n\n// PUT - Update project staff assignment\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n    const projectStaffId = parseInt(id);\n    const body = await request.json();\n    const validatedData = updateProjectStaffSchema.parse(body);\n\n    // Check if the assignment exists\n    const existingAssignment = await prisma.projectStaff.findUnique({\n      where: { id: projectStaffId },\n    });\n\n    if (!existingAssignment) {\n      return NextResponse.json(\n        { success: false, error: 'Project staff assignment not found' },\n        { status: 404 }\n      );\n    }\n\n    const updateData: any = { ...validatedData };\n    \n    // Handle date fields\n    if (validatedData.startDate !== undefined) {\n      updateData.startDate = validatedData.startDate ? new Date(validatedData.startDate) : null;\n    }\n    if (validatedData.endDate !== undefined) {\n      updateData.endDate = validatedData.endDate ? new Date(validatedData.endDate) : null;\n    }\n\n    const updatedProjectStaff = await prisma.projectStaff.update({\n      where: { id: projectStaffId },\n      data: updateData,\n      include: {\n        staff: true,\n        position: true,\n        project: {\n          select: {\n            id: true,\n            projectName: true,\n            projectCode: true,\n          },\n        },\n      },\n    });\n\n    return NextResponse.json({\n      success: true,\n      data: updatedProjectStaff,\n      message: 'Project staff assignment updated successfully',\n    });\n  } catch (error) {\n    console.error('Error updating project staff assignment:', error);\n    if (error instanceof z.ZodError) {\n      return NextResponse.json(\n        { success: false, error: 'Validation error', details: error.errors },\n        { status: 400 }\n      );\n    }\n    return NextResponse.json(\n      { success: false, error: 'Failed to update project staff assignment' },\n      { status: 500 }\n    );\n  }\n}\n\n// DELETE - Remove staff from project\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n    const projectStaffId = parseInt(id);\n\n    // Check if the assignment exists\n    const existingAssignment = await prisma.projectStaff.findUnique({\n      where: { id: projectStaffId },\n    });\n\n    if (!existingAssignment) {\n      return NextResponse.json(\n        { success: false, error: 'Project staff assignment not found' },\n        { status: 404 }\n      );\n    }\n\n    await prisma.projectStaff.delete({\n      where: { id: projectStaffId },\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: 'Staff removed from project successfully',\n    });\n  } catch (error) {\n    console.error('Error removing staff from project:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to remove staff from project' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}