{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma; "],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/app/api/admin/projects/%5Bid%5D/checklist/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { z } from 'zod';\nimport { prisma } from '@/lib/db';\n\nconst checklistItemSchema = z.object({\n  itemNumber: z.string().optional().or(z.literal('')),\n  phase: z.string().min(1, 'Phase description is required'),\n  plannedDate: z.string().optional().or(z.null()),\n  actualDate: z.string().optional().or(z.null()),\n  status: z.enum(['Pending', 'In Progress', 'Completed', 'On Hold', 'Cancelled']).optional().or(z.null()),\n  notes: z.string().optional().or(z.null()),\n  isSubItem: z.boolean().default(false),\n  parentItemId: z.number().optional().or(z.null()),\n  order: z.number().optional().default(0),\n});\n\n// GET - Fetch all checklist items for a project\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n    const projectId = parseInt(id);\n    \n    if (isNaN(projectId)) {\n      return NextResponse.json(\n        { success: false, error: 'Invalid project ID' },\n        { status: 400 }\n      );\n    }\n\n    const checklistItems = await prisma.projectChecklistItem.findMany({\n      where: { projectId },\n      orderBy: [\n        { order: 'asc' }\n      ],\n    });\n\n    return NextResponse.json({ success: true, data: checklistItems });\n  } catch (error) {\n    console.error('Error fetching project checklist:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch project checklist' },\n      { status: 500 }\n    );\n  }\n}\n\n// POST - Create new checklist item\nexport async function POST(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n    const projectId = parseInt(id);\n    \n    if (isNaN(projectId)) {\n      return NextResponse.json(\n        { success: false, error: 'Invalid project ID' },\n        { status: 400 }\n      );\n    }\n\n    const body = await request.json();\n    const validatedData = checklistItemSchema.parse(body);\n\n    // Convert date strings to DateTime objects if provided\n    const checklistData = {\n      ...validatedData,\n      projectId,\n      itemNumber: validatedData.itemNumber || '', // Add itemNumber field\n      order: validatedData.order || 0, // Add order field\n      plannedDate: validatedData.plannedDate ? new Date(validatedData.plannedDate) : null,\n      actualDate: validatedData.actualDate ? new Date(validatedData.actualDate) : null,\n    };\n\n    const checklistItem = await prisma.projectChecklistItem.create({\n      data: checklistData,\n    });\n\n    return NextResponse.json({ success: true, data: checklistItem });\n  } catch (error) {\n    console.error('Error creating checklist item:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to create checklist item' },\n      { status: 500 }\n    );\n  }\n}\n\n// PUT - Update multiple checklist items (bulk update)\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params;\n    const projectId = parseInt(id);\n    \n    if (isNaN(projectId)) {\n      return NextResponse.json(\n        { success: false, error: 'Invalid project ID' },\n        { status: 400 }\n      );\n    }\n\n    const body = await request.json();\n    const { items } = body;\n\n    if (!Array.isArray(items)) {\n      return NextResponse.json(\n        { success: false, error: 'Items must be an array' },\n        { status: 400 }\n      );\n    }\n\n    // Use transaction to update all items atomically\n    const result = await prisma.$transaction(async (tx) => {\n      const updatedItems = [];\n      \n      for (const item of items) {\n        const validatedData = checklistItemSchema.parse(item);\n        \n        const updateData = {\n          ...validatedData,\n          order: validatedData.order || 0, // Add order field\n          plannedDate: validatedData.plannedDate ? new Date(validatedData.plannedDate) : null,\n          actualDate: validatedData.actualDate ? new Date(validatedData.actualDate) : null,\n        };\n\n        const updatedItem = await tx.projectChecklistItem.update({\n          where: { id: item.id },\n          data: updateData,\n        });\n        \n        updatedItems.push(updatedItem);\n      }\n      \n      return updatedItems;\n    });\n\n    return NextResponse.json({ success: true, data: result });\n  } catch (error) {\n    console.error('Error updating checklist items:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to update checklist items' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}