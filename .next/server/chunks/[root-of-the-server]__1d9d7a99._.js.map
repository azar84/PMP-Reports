{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma; "],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/validations.ts"],"sourcesContent":["import { z } from 'zod';\n\n// Common validations\nexport const IdSchema = z.number().int().positive();\nexport const SlugSchema = z.string().min(1).max(100).regex(/^[a-zA-Z0-9-_]+$/, 'Invalid slug format');\nexport const UrlSchema = z.string().url('Invalid URL format');\n\n// Helper for optional string fields that can be empty\nconst optionalString = z.string().optional().nullable().transform(val => val === '' ? null : val);\nconst optionalUrl = z.string().optional().nullable().transform(val => val === '' ? null : val).refine(val => {\n  if (val === null || val === undefined) return true;\n  // Allow data URIs for base64 encoded images\n  if (val.startsWith('data:')) return true;\n  // Allow relative paths (starting with /)\n  if (val.startsWith('/')) return true;\n  // Allow regular URLs\n  return z.string().url().safeParse(val).success;\n}, { message: \"Invalid URL format\" });\nconst optionalEmail = z.string().optional().nullable().transform(val => val === '' ? null : val).refine(val => {\n  if (val === null || val === undefined) return true;\n  return z.string().email().safeParse(val).success;\n}, { message: \"Invalid email format\" });\n\n// Site Settings Schema\nexport const SiteSettingsSchema = z.object({\n  logoUrl: optionalUrl,\n  logoLightUrl: optionalUrl,\n  logoDarkUrl: optionalUrl,\n  faviconUrl: optionalUrl,\n  faviconLightUrl: optionalUrl,\n  faviconDarkUrl: optionalUrl,\n  \n  // Email Configuration\n  smtpEnabled: z.boolean().optional(),\n  smtpHost: optionalString,\n  smtpPort: z.number().int().min(1).max(65535).optional().nullable(),\n  smtpSecure: z.boolean().optional(),\n  smtpUsername: optionalString,\n  smtpPassword: optionalString,\n  smtpFromEmail: optionalEmail,\n  smtpFromName: optionalString,\n  smtpReplyTo: optionalEmail,\n  \n  // Email Templates Configuration\n  emailSignature: optionalString,\n  emailFooterText: optionalString,\n  emailBrandingEnabled: z.boolean().optional(),\n  \n  // Email Notification Settings\n  adminNotificationEmail: optionalEmail,\n  emailLoggingEnabled: z.boolean().optional(),\n  emailRateLimitPerHour: z.number().int().min(1).max(1000).optional().nullable(),\n  \n  // Social Media Links\n  socialFacebook: optionalUrl,\n  socialTwitter: optionalUrl,\n  socialLinkedin: optionalUrl,\n  socialInstagram: optionalUrl,\n  socialYoutube: optionalUrl,\n  \n  // Contact Information\n  companyPhone: optionalString,\n  companyEmail: optionalEmail,\n  companyAddress: optionalString,\n  \n  // Footer Settings\n  footerCompanyName: optionalString,\n  footerCompanyDescription: optionalString,\n  footerNewsletterFormId: z.number().int().positive().optional().nullable(),\n  footerCopyrightMessage: optionalString,\n  footerMenuIds: optionalString,\n  footerShowContactInfo: z.boolean().optional(),\n  footerShowSocialLinks: z.boolean().optional(),\n  footerBackgroundColor: optionalString,\n  footerTextColor: optionalString,\n  \n  // SEO & Analytics\n  baseUrl: optionalUrl,\n  gaMeasurementId: optionalString,\n  gtmContainerId: optionalString,\n  gtmEnabled: z.boolean().optional(),\n  \n  // Cloudinary Configuration\n  cloudinaryCloudName: optionalString,\n  cloudinaryApiKey: optionalString,\n  cloudinaryApiSecret: optionalString,\n  cloudinaryUploadPreset: optionalString,\n  cloudinaryEnabled: z.boolean().optional(),\n  \n  // Sidebar Configuration\n  sidebarBackgroundColor: optionalString,\n  sidebarTextColor: optionalString,\n  sidebarSelectedColor: optionalString,\n  sidebarHoverColor: optionalString,\n});\n\nexport const SiteSettingsUpdateSchema = SiteSettingsSchema.partial();\n\n// API Response Type\nexport const ApiResponseSchema = z.object({\n  success: z.boolean(),\n  data: z.unknown().optional(),\n  message: z.string().optional(),\n  error: z.string().optional(),\n});\n\nexport type ApiResponse<T = unknown> = {\n  success: boolean;\n  data?: T;\n  message?: string;\n  error?: string;\n};\n\n// Validation helper function\nexport function validateAndTransform<T>(schema: z.ZodSchema<T>, data: unknown): T {\n  return schema.parse(data);\n}\n\n// Media Library Schemas\nexport const CreateMediaLibrarySchema = z.object({\n  filename: z.string().min(1).max(255),\n  title: optionalString,\n  description: optionalString,\n  alt: optionalString,\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']),\n  mimeType: z.string().min(1).max(100),\n  fileSize: z.number().int().positive(),\n  width: z.number().int().positive().optional().nullable(),\n  height: z.number().int().positive().optional().nullable(),\n  duration: z.number().positive().optional().nullable(),\n  originalUrl: z.string().url(),\n  localPath: optionalString,\n  publicUrl: z.string().url(),\n  thumbnailUrl: optionalUrl,\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: optionalString,\n  uploadSource: z.enum(['upload', 'url', 'cloudinary']).optional(),\n  uploadedBy: optionalString,\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n});\n\nexport const UpdateMediaLibrarySchema = z.object({\n  id: z.number().int().positive(),\n  filename: z.string().min(1).max(255).optional(),\n  title: optionalString,\n  description: optionalString,\n  alt: optionalString,\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']).optional(),\n  mimeType: z.string().min(1).max(100).optional(),\n  fileSize: z.number().int().positive().optional(),\n  width: z.number().int().positive().optional().nullable(),\n  height: z.number().int().positive().optional().nullable(),\n  duration: z.number().positive().optional().nullable(),\n  originalUrl: z.string().url().optional(),\n  localPath: optionalString,\n  publicUrl: z.string().url().optional(),\n  thumbnailUrl: optionalUrl,\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: optionalString,\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n});\n\n// Media Folder Schemas\nexport const CreateMediaFolderSchema = z.object({\n  name: z.string().min(1).max(100),\n  description: optionalString,\n  parentId: z.number().int().positive().optional().nullable(),\n  color: z.string().regex(/^#[0-9A-Fa-f]{6}$/, 'Invalid hex color').optional(),\n  sortOrder: z.number().int().optional(),\n  isActive: z.boolean().optional(),\n});\n\nexport const UpdateMediaFolderSchema = z.object({\n  id: z.number().int().positive(),\n  name: z.string().min(1).max(100).optional(),\n  description: optionalString,\n  parentId: z.number().int().positive().optional().nullable(),\n  color: z.string().regex(/^#[0-9A-Fa-f]{6}$/, 'Invalid hex color').optional(),\n  sortOrder: z.number().int().optional(),\n  isActive: z.boolean().optional(),\n});\n\n// Media Usage Schema\nexport const CreateMediaUsageSchema = z.object({\n  mediaId: z.number().int().positive(),\n  entityType: z.string().min(1).max(50),\n  entityId: z.number().int().positive(),\n  fieldName: z.string().min(1).max(100),\n});\n\n// Media Upload/Import Schemas\nexport const MediaUploadSchema = z.object({\n  file: z.instanceof(File),\n  folderId: z.number().int().positive().optional().nullable(),\n  title: optionalString,\n  alt: optionalString,\n  description: optionalString,\n});\n\nexport const MediaUrlImportSchema = z.object({\n  url: z.string().url(),\n  folderId: z.number().int().positive().optional().nullable(),\n  title: optionalString,\n  alt: optionalString,\n  description: optionalString,\n  tags: z.array(z.string()).optional(),\n});\n\n// Media Search Schema\nexport const MediaSearchSchema = z.object({\n  query: z.string().optional(),\n  fileType: z.enum(['image', 'video', 'audio', 'document', 'other']).optional(),\n  folderId: z.number().int().positive().optional().nullable(),\n  tags: z.array(z.string()).optional(),\n  isActive: z.boolean().optional(),\n  isPublic: z.boolean().optional(),\n  sortBy: z.enum(['createdAt', 'updatedAt', 'filename', 'fileSize']).optional(),\n  sortOrder: z.enum(['asc', 'desc']).optional(),\n  page: z.number().int().min(1).optional(),\n  limit: z.number().int().min(1).max(100).optional(),\n  offset: z.number().int().min(0).optional(),\n});\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 391, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/lib/cloudinary.ts"],"sourcesContent":["import { v2 as cloudinary } from 'cloudinary';\nimport { prisma } from './db';\n\n// Function to get Cloudinary config from database\nexport async function getCloudinaryConfig() {\n  try {\n    console.log('Getting Cloudinary configuration from database...');\n    \n    // Test database connection first\n    try {\n      await prisma.$connect();\n      console.log('Database connection successful');\n    } catch (dbError) {\n      console.error('Database connection failed:', dbError);\n      throw new Error('Database connection failed - cannot retrieve Cloudinary configuration');\n    }\n    \n    // Get settings from database\n    const settings = await prisma.siteSettings.findFirst();\n    console.log('Site settings loaded:', {\n      hasSettings: !!settings,\n      cloudinaryEnabled: settings?.cloudinaryEnabled,\n      hasCloudName: !!settings?.cloudinaryCloudName,\n      hasApiKey: !!settings?.cloudinaryApiKey,\n      hasApiSecret: !!settings?.cloudinaryApiSecret\n    });\n    \n    if (settings?.cloudinaryEnabled && settings.cloudinaryCloudName && settings.cloudinaryApiKey && settings.cloudinaryApiSecret) {\n      console.log('Using database Cloudinary configuration');\n      return {\n        cloud_name: settings.cloudinaryCloudName,\n        api_key: settings.cloudinaryApiKey,\n        api_secret: settings.cloudinaryApiSecret,\n      };\n    }\n    \n    console.log('No Cloudinary configuration found in database');\n    console.log('Please configure Cloudinary in the admin panel under Site Settings');\n    return null;\n  } catch (error) {\n    console.error('Error getting Cloudinary config from database:', error);\n    throw new Error('Failed to retrieve Cloudinary configuration from database');\n  }\n}\n\n// Function to configure Cloudinary with database settings or environment variables\nexport async function configureCloudinary() {\n  try {\n    const config = await getCloudinaryConfig();\n    \n    if (!config) {\n      console.warn('Cloudinary not configured - media uploads will be disabled');\n      return false;\n    }\n    \n    // Validate the configuration\n    if (!config.cloud_name || !config.api_key || !config.api_secret) {\n      console.error('Invalid Cloudinary configuration - missing required fields');\n      return false;\n    }\n    \n    // Configure Cloudinary\n    cloudinary.config(config);\n    \n    // Test the configuration by making a simple API call\n    try {\n      // This is a lightweight test to verify credentials\n      await new Promise((resolve, reject) => {\n        cloudinary.api.ping((error, result) => {\n          if (error) {\n            console.error('Cloudinary ping failed:', error);\n            reject(error);\n          } else {\n            console.log('Cloudinary configuration verified successfully');\n            resolve(result);\n          }\n        });\n      });\n    } catch (pingError) {\n      console.error('Cloudinary configuration test failed:', pingError);\n      return false;\n    }\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to configure Cloudinary:', error);\n    return false;\n  }\n}\n\n// Don't initialize Cloudinary configuration at module level\n// It will be configured when needed\n\nexport interface CloudinaryUploadResult {\n  public_id: string;\n  secure_url: string;\n  url: string;\n  width?: number;\n  height?: number;\n  format: string;\n  resource_type: string;\n  bytes: number;\n}\n\nexport const uploadToCloudinary = async (\n  file: any, // Changed from File | Buffer to any to handle both browser File and Node.js Buffer\n  options: {\n    folder?: string;\n    public_id?: string;\n    resource_type?: 'image' | 'video' | 'raw';\n    transformation?: any[];\n  } = {}\n): Promise<CloudinaryUploadResult> => {\n  try {\n    console.log('Starting Cloudinary upload...');\n    \n    // Ensure Cloudinary is configured\n    const isConfigured = await configureCloudinary();\n    \n    if (!isConfigured) {\n      throw new Error('Cloudinary is not configured. Please configure Cloudinary in site settings or environment variables.');\n    }\n\n    // Convert File to buffer if needed\n    let buffer: Buffer;\n    if (file && typeof file.arrayBuffer === 'function') {\n      // This is a browser File object\n      console.log('Converting File to buffer...');\n      const arrayBuffer = await file.arrayBuffer();\n      buffer = Buffer.from(arrayBuffer);\n      console.log(`File converted to buffer, size: ${buffer.length} bytes`);\n    } else if (Buffer.isBuffer(file)) {\n      // This is already a Buffer\n      buffer = file;\n      console.log(`Using provided buffer, size: ${buffer.length} bytes`);\n    } else {\n      throw new Error('Invalid file type provided');\n    }\n\n    // Validate buffer\n    if (!buffer || buffer.length === 0) {\n      throw new Error('Empty file buffer provided');\n    }\n\n    console.log('Uploading to Cloudinary with options:', {\n      folder: options.folder || 'pmp-reports',\n      resource_type: options.resource_type || 'auto',\n      public_id: options.public_id\n    });\n\n    // Upload to Cloudinary\n    const result = await new Promise<CloudinaryUploadResult>((resolve, reject) => {\n      const uploadStream = cloudinary.uploader.upload_stream(\n        {\n          folder: options.folder || 'pmp-reports',\n          public_id: options.public_id,\n          resource_type: options.resource_type || 'auto',\n          transformation: options.transformation,\n        },\n        (error, result) => {\n          if (error) {\n            console.error('Cloudinary upload stream error:', error);\n            reject(error);\n          } else {\n            console.log('Cloudinary upload successful:', {\n              public_id: result?.public_id,\n              secure_url: result?.secure_url,\n              bytes: result?.bytes\n            });\n            resolve(result as CloudinaryUploadResult);\n          }\n        }\n      );\n\n      uploadStream.end(buffer);\n    });\n\n    return result;\n  } catch (error) {\n    console.error('Cloudinary upload error:', error);\n    \n    // Provide more specific error messages\n    if (error instanceof Error) {\n      if (error.message.includes('not configured')) {\n        throw new Error('Cloudinary is not configured. Please configure Cloudinary in site settings or environment variables.');\n      } else if (error.message.includes('Invalid API key')) {\n        throw new Error('Invalid Cloudinary API key. Please check your credentials.');\n      } else if (error.message.includes('Invalid signature')) {\n        throw new Error('Invalid Cloudinary API secret. Please check your credentials.');\n      } else if (error.message.includes('Cloud name')) {\n        throw new Error('Invalid Cloudinary cloud name. Please check your configuration.');\n      } else if (error.message.includes('Empty file buffer')) {\n        throw new Error('The uploaded file is empty or corrupted.');\n      } else {\n        throw new Error(`Cloudinary upload failed: ${error.message}`);\n      }\n    }\n    \n    throw new Error('Failed to upload file to Cloudinary');\n  }\n};\n\nexport const deleteFromCloudinary = async (public_id: string): Promise<void> => {\n  try {\n    // Ensure Cloudinary is configured\n    const isConfigured = await configureCloudinary();\n    \n    if (!isConfigured) {\n      console.warn('Cloudinary is not configured - skipping delete operation');\n      return;\n    }\n    \n    await cloudinary.uploader.destroy(public_id);\n  } catch (error) {\n    console.error('Cloudinary delete error:', error);\n    throw new Error('Failed to delete file from Cloudinary');\n  }\n};\n\nexport const getCloudinaryUrl = (public_id: string, options: {\n  transformation?: any[];\n  format?: string;\n} = {}): string => {\n  // This function doesn't need configuration check as it just generates URLs\n  // But we should ensure Cloudinary is configured for consistency\n  try {\n    // Note: This is a synchronous operation, so we can't await configureCloudinary\n    // The URL generation should work even without full configuration\n    return cloudinary.url(public_id, {\n      secure: true,\n      ...options,\n    });\n  } catch (error) {\n    console.error('Error generating Cloudinary URL:', error);\n    // Return a fallback URL or the original public_id\n    return public_id;\n  }\n}; "],"names":[],"mappings":";;;;;;;AAAA;AACA;;;AAGO,eAAe;IACpB,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,iCAAiC;QACjC,IAAI;YACF,MAAM,kHAAA,CAAA,SAAM,CAAC,QAAQ;YACrB,QAAQ,GAAG,CAAC;QACd,EAAE,OAAO,SAAS;YAChB,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,MAAM,IAAI,MAAM;QAClB;QAEA,6BAA6B;QAC7B,MAAM,WAAW,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,SAAS;QACpD,QAAQ,GAAG,CAAC,yBAAyB;YACnC,aAAa,CAAC,CAAC;YACf,mBAAmB,UAAU;YAC7B,cAAc,CAAC,CAAC,UAAU;YAC1B,WAAW,CAAC,CAAC,UAAU;YACvB,cAAc,CAAC,CAAC,UAAU;QAC5B;QAEA,IAAI,UAAU,qBAAqB,SAAS,mBAAmB,IAAI,SAAS,gBAAgB,IAAI,SAAS,mBAAmB,EAAE;YAC5H,QAAQ,GAAG,CAAC;YACZ,OAAO;gBACL,YAAY,SAAS,mBAAmB;gBACxC,SAAS,SAAS,gBAAgB;gBAClC,YAAY,SAAS,mBAAmB;YAC1C;QACF;QAEA,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kDAAkD;QAChE,MAAM,IAAI,MAAM;IAClB;AACF;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM;QAErB,IAAI,CAAC,QAAQ;YACX,QAAQ,IAAI,CAAC;YACb,OAAO;QACT;QAEA,6BAA6B;QAC7B,IAAI,CAAC,OAAO,UAAU,IAAI,CAAC,OAAO,OAAO,IAAI,CAAC,OAAO,UAAU,EAAE;YAC/D,QAAQ,KAAK,CAAC;YACd,OAAO;QACT;QAEA,uBAAuB;QACvB,0IAAA,CAAA,KAAU,CAAC,MAAM,CAAC;QAElB,qDAAqD;QACrD,IAAI;YACF,mDAAmD;YACnD,MAAM,IAAI,QAAQ,CAAC,SAAS;gBAC1B,0IAAA,CAAA,KAAU,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,OAAO;oBAC1B,IAAI,OAAO;wBACT,QAAQ,KAAK,CAAC,2BAA2B;wBACzC,OAAO;oBACT,OAAO;wBACL,QAAQ,GAAG,CAAC;wBACZ,QAAQ;oBACV;gBACF;YACF;QACF,EAAE,OAAO,WAAW;YAClB,QAAQ,KAAK,CAAC,yCAAyC;YACvD,OAAO;QACT;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO;IACT;AACF;AAgBO,MAAM,qBAAqB,OAChC,MACA,UAKI,CAAC,CAAC;IAEN,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,kCAAkC;QAClC,MAAM,eAAe,MAAM;QAE3B,IAAI,CAAC,cAAc;YACjB,MAAM,IAAI,MAAM;QAClB;QAEA,mCAAmC;QACnC,IAAI;QACJ,IAAI,QAAQ,OAAO,KAAK,WAAW,KAAK,YAAY;YAClD,gCAAgC;YAChC,QAAQ,GAAG,CAAC;YACZ,MAAM,cAAc,MAAM,KAAK,WAAW;YAC1C,SAAS,OAAO,IAAI,CAAC;YACrB,QAAQ,GAAG,CAAC,CAAC,gCAAgC,EAAE,OAAO,MAAM,CAAC,MAAM,CAAC;QACtE,OAAO,IAAI,OAAO,QAAQ,CAAC,OAAO;YAChC,2BAA2B;YAC3B,SAAS;YACT,QAAQ,GAAG,CAAC,CAAC,6BAA6B,EAAE,OAAO,MAAM,CAAC,MAAM,CAAC;QACnE,OAAO;YACL,MAAM,IAAI,MAAM;QAClB;QAEA,kBAAkB;QAClB,IAAI,CAAC,UAAU,OAAO,MAAM,KAAK,GAAG;YAClC,MAAM,IAAI,MAAM;QAClB;QAEA,QAAQ,GAAG,CAAC,yCAAyC;YACnD,QAAQ,QAAQ,MAAM,IAAI;YAC1B,eAAe,QAAQ,aAAa,IAAI;YACxC,WAAW,QAAQ,SAAS;QAC9B;QAEA,uBAAuB;QACvB,MAAM,SAAS,MAAM,IAAI,QAAgC,CAAC,SAAS;YACjE,MAAM,eAAe,0IAAA,CAAA,KAAU,CAAC,QAAQ,CAAC,aAAa,CACpD;gBACE,QAAQ,QAAQ,MAAM,IAAI;gBAC1B,WAAW,QAAQ,SAAS;gBAC5B,eAAe,QAAQ,aAAa,IAAI;gBACxC,gBAAgB,QAAQ,cAAc;YACxC,GACA,CAAC,OAAO;gBACN,IAAI,OAAO;oBACT,QAAQ,KAAK,CAAC,mCAAmC;oBACjD,OAAO;gBACT,OAAO;oBACL,QAAQ,GAAG,CAAC,iCAAiC;wBAC3C,WAAW,QAAQ;wBACnB,YAAY,QAAQ;wBACpB,OAAO,QAAQ;oBACjB;oBACA,QAAQ;gBACV;YACF;YAGF,aAAa,GAAG,CAAC;QACnB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAE1C,uCAAuC;QACvC,IAAI,iBAAiB,OAAO;YAC1B,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,mBAAmB;gBAC5C,MAAM,IAAI,MAAM;YAClB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,oBAAoB;gBACpD,MAAM,IAAI,MAAM;YAClB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;gBACtD,MAAM,IAAI,MAAM;YAClB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,eAAe;gBAC/C,MAAM,IAAI,MAAM;YAClB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;gBACtD,MAAM,IAAI,MAAM;YAClB,OAAO;gBACL,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,MAAM,OAAO,EAAE;YAC9D;QACF;QAEA,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,MAAM,uBAAuB,OAAO;IACzC,IAAI;QACF,kCAAkC;QAClC,MAAM,eAAe,MAAM;QAE3B,IAAI,CAAC,cAAc;YACjB,QAAQ,IAAI,CAAC;YACb;QACF;QAEA,MAAM,0IAAA,CAAA,KAAU,CAAC,QAAQ,CAAC,OAAO,CAAC;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,MAAM,mBAAmB,CAAC,WAAmB,UAGhD,CAAC,CAAC;IACJ,2EAA2E;IAC3E,gEAAgE;IAChE,IAAI;QACF,+EAA+E;QAC/E,iEAAiE;QACjE,OAAO,0IAAA,CAAA,KAAU,CAAC,GAAG,CAAC,WAAW;YAC/B,QAAQ;YACR,GAAG,OAAO;QACZ;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,kDAAkD;QAClD,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 586, "column": 0}, "map": {"version":3,"sources":["file:///Users/azarmacbook/Cursor%20Projects/PMP-%20Reports/src/app/api/admin/media-library/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { prisma } from '@/lib/db';\nimport { \n  CreateMediaLibrarySchema, \n  UpdateMediaLibrarySchema, \n  MediaSearchSchema,\n  MediaUrlImportSchema,\n  validateAndTransform,\n  type ApiResponse \n} from '@/lib/validations';\nimport { uploadToCloudinary, deleteFromCloudinary } from '@/lib/cloudinary';\n\n// GET - Fetch media library items with search and filtering\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    \n    // Parse search parameters\n    const searchData = {\n      query: searchParams.get('query') || undefined,\n      fileType: searchParams.get('fileType') || undefined,\n      folderId: searchParams.get('folderId') ? parseInt(searchParams.get('folderId')!) : undefined,\n      tags: searchParams.get('tags')?.split(',') || undefined,\n      isActive: searchParams.get('isActive') ? searchParams.get('isActive') === 'true' : undefined,\n      isPublic: searchParams.get('isPublic') ? searchParams.get('isPublic') === 'true' : undefined,\n      page: parseInt(searchParams.get('page') || '1'),\n      limit: parseInt(searchParams.get('limit') || '20'),\n      sortBy: searchParams.get('sortBy') || 'createdAt',\n      sortOrder: searchParams.get('sortOrder') || 'desc'\n    };\n\n    // Validate search parameters\n    const validatedSearch = validateAndTransform(MediaSearchSchema, searchData);\n\n    // Build where clause\n    const where: any = {};\n    \n    if (validatedSearch.query) {\n      where.OR = [\n        { filename: { contains: validatedSearch.query, mode: 'insensitive' } },\n        { title: { contains: validatedSearch.query, mode: 'insensitive' } },\n        { description: { contains: validatedSearch.query, mode: 'insensitive' } },\n        { alt: { contains: validatedSearch.query, mode: 'insensitive' } }\n      ];\n    }\n    \n    if (validatedSearch.fileType) {\n      where.fileType = validatedSearch.fileType;\n    }\n    \n    if (validatedSearch.folderId !== undefined) {\n      where.folderId = validatedSearch.folderId;\n    }\n    \n    if (validatedSearch.isActive !== undefined) {\n      where.isActive = validatedSearch.isActive;\n    }\n    \n    if (validatedSearch.isPublic !== undefined) {\n      where.isPublic = validatedSearch.isPublic;\n    }\n\n    if (validatedSearch.tags && validatedSearch.tags.length > 0) {\n      // Search in JSON tags field\n      where.tags = {\n        contains: JSON.stringify(validatedSearch.tags[0])\n      };\n    }\n\n    // Calculate pagination\n    const skip = ((validatedSearch.page || 1) - 1) * (validatedSearch.limit || 50);\n\n    // Get total count\n    const totalCount = await prisma.mediaLibrary.count({ where });\n\n    // Fetch media items\n    const mediaItems = await prisma.mediaLibrary.findMany({\n      where,\n      include: {\n        folder: {\n          select: {\n            id: true,\n            name: true,\n            color: true\n          }\n        },\n        usages: {\n          select: {\n            entityType: true,\n            entityId: true,\n            fieldName: true\n          }\n        }\n      },\n      orderBy: {\n        [validatedSearch.sortBy as string]: validatedSearch.sortOrder\n      },\n      skip,\n      take: validatedSearch.limit || 50\n    });\n\n    // Calculate pagination info\n    const totalPages = Math.ceil(totalCount / (validatedSearch.limit || 50));\n    const currentPage = validatedSearch.page || 1;\n    const hasNextPage = currentPage < totalPages;\n    const hasPrevPage = currentPage > 1;\n\n    const response: ApiResponse = {\n      success: true,\n      data: {\n        items: mediaItems,\n        pagination: {\n          page: currentPage,\n          limit: validatedSearch.limit || 50,\n          totalCount,\n          totalPages,\n          hasNextPage,\n          hasPrevPage\n        }\n      }\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('Failed to fetch media library:', error);\n    \n    const response: ApiResponse = {\n      success: false,\n      message: error instanceof Error ? error.message : 'Failed to fetch media library'\n    };\n    \n    const statusCode = error instanceof Error && error.message.includes('Validation failed') ? 400 : 500;\n    return NextResponse.json(response, { status: statusCode });\n  }\n}\n\n// POST - Create new media item (upload or URL import)\nexport async function POST(request: NextRequest) {\n  try {\n    console.log('ðŸ“¤ Starting media library POST request...');\n    const contentType = request.headers.get('content-type') || '';\n    console.log('ðŸ“‹ Content-Type:', contentType);\n    \n    if (contentType.includes('multipart/form-data')) {\n      // Handle file upload\n      console.log('ðŸ“ Handling file upload...');\n      return handleFileUpload(request);\n    } else {\n      // Handle URL import\n      console.log('ðŸ”— Handling URL import...');\n      return handleUrlImport(request);\n    }\n  } catch (error) {\n    console.error('âŒ Failed to create media item:', error);\n    \n    // Provide more detailed error information\n    let errorMessage = 'Failed to create media item';\n    let statusCode = 500;\n    \n    if (error instanceof Error) {\n      errorMessage = error.message;\n      \n      // Handle specific error types\n      if (error.message.includes('Cloudinary is not configured')) {\n        statusCode = 400;\n        errorMessage = 'Cloudinary is not configured. Please configure Cloudinary in site settings or environment variables.';\n      } else if (error.message.includes('Database connection failed')) {\n        statusCode = 500;\n        errorMessage = 'Database connection failed. Please check your database configuration.';\n      } else if (error.message.includes('Validation failed')) {\n        statusCode = 400;\n      }\n    }\n    \n    const response: ApiResponse = {\n      success: false,\n      message: errorMessage\n    };\n    \n    return NextResponse.json(response, { status: statusCode });\n  }\n}\n\n// Handle file upload\nasync function handleFileUpload(request: NextRequest) {\n  try {\n    console.log('ðŸ“ Starting file upload process...');\n    \n    const formData = await request.formData();\n    const file = formData.get('file') as File;\n    \n    console.log('ðŸ“„ File received:', {\n      name: file?.name,\n      size: file?.size,\n      type: file?.type,\n      lastModified: file?.lastModified\n    });\n    \n    if (!file) {\n      console.error('âŒ No file provided in request');\n      const response: ApiResponse = {\n        success: false,\n        message: 'No file provided'\n      };\n      return NextResponse.json(response, { status: 400 });\n    }\n\n    // Validate file\n    const maxSize = 50 * 1024 * 1024; // 50MB\n    if (file.size > maxSize) {\n      console.error('âŒ File size exceeds limit:', file.size, 'bytes');\n      const response: ApiResponse = {\n        success: false,\n        message: 'File size exceeds 50MB limit'\n      };\n      return NextResponse.json(response, { status: 400 });\n    }\n\n    // Get file info\n    const filename = file.name;\n    const mimeType = file.type;\n    const fileSize = file.size;\n    \n    console.log('ðŸ“‹ File details:', {\n      filename,\n      mimeType,\n      fileSize,\n      maxSize\n    });\n    \n    // Determine file type\n    let fileType = 'other';\n    let resourceType: 'image' | 'video' | 'raw' = 'raw';\n    if (mimeType.startsWith('image/')) {\n      fileType = 'image';\n      resourceType = 'image';\n    } else if (mimeType.startsWith('video/')) {\n      fileType = 'video';\n      resourceType = 'video';\n    } else if (mimeType.startsWith('audio/')) {\n      fileType = 'audio';\n      resourceType = 'raw';\n    } else if (mimeType.includes('pdf') || mimeType.includes('document') || mimeType.includes('text')) {\n      fileType = 'document';\n      resourceType = 'raw';\n    }\n    \n    console.log('ðŸ·ï¸  File type determined:', {\n      fileType,\n      resourceType\n    });\n\n  try {\n    console.log('â˜ï¸  Starting Cloudinary upload...');\n    \n    // Upload to Cloudinary\n    const cloudinaryResult = await uploadToCloudinary(file, {\n      folder: 'yourcompany/media',\n      resource_type: resourceType,\n    });\n    \n    console.log('âœ… Cloudinary upload successful:', {\n      public_id: cloudinaryResult.public_id,\n      secure_url: cloudinaryResult.secure_url,\n      bytes: cloudinaryResult.bytes,\n      width: cloudinaryResult.width,\n      height: cloudinaryResult.height\n    });\n\n    // Get optional metadata from form\n    const title = formData.get('title')?.toString();\n    const description = formData.get('description')?.toString();\n    const alt = formData.get('alt')?.toString();\n    const folderId = formData.get('folderId') ? parseInt(formData.get('folderId')!.toString()) : null;\n    const tagsString = formData.get('tags')?.toString();\n    const tags = tagsString ? JSON.stringify(tagsString.split(',').map(tag => tag.trim())) : null;\n\n    // Create media record\n    const mediaData = {\n      filename,\n      title: title || filename,\n      description,\n      alt,\n      fileType,\n      mimeType,\n      fileSize: cloudinaryResult.bytes,\n      width: cloudinaryResult.width,\n      height: cloudinaryResult.height,\n      duration: undefined, // Cloudinary doesn't provide duration for all files\n      originalUrl: cloudinaryResult.secure_url,\n      localPath: cloudinaryResult.public_id, // Store Cloudinary public_id instead of local path\n      publicUrl: cloudinaryResult.secure_url,\n      folderId,\n      tags,\n      uploadSource: 'upload' as const,\n      isActive: true,\n      isPublic: true\n    };\n\n    console.log('ðŸ’¾ Creating database record...');\n    \n    const validatedData = validateAndTransform(CreateMediaLibrarySchema, mediaData);\n    console.log('âœ… Data validation successful');\n\n    const mediaItem = await prisma.mediaLibrary.create({\n      data: validatedData,\n      include: {\n        folder: {\n          select: {\n            id: true,\n            name: true,\n            color: true\n          }\n        }\n      }\n    });\n    \n    console.log('âœ… Database record created:', {\n      id: mediaItem.id,\n      filename: mediaItem.filename,\n      publicUrl: mediaItem.publicUrl\n    });\n\n    const response: ApiResponse = {\n      success: true,\n      data: mediaItem,\n      message: 'File uploaded successfully'\n    };\n\n    console.log('âœ… File upload completed successfully');\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('âŒ Cloudinary upload error:', error);\n    \n    let errorMessage = 'Failed to upload file to Cloudinary';\n    let statusCode = 500;\n    \n    if (error instanceof Error) {\n      if (error.message.includes('not configured')) {\n        errorMessage = 'Cloudinary is not configured. Please configure Cloudinary in site settings.';\n        statusCode = 400;\n      } else if (error.message.includes('Invalid API key')) {\n        errorMessage = 'Invalid Cloudinary API key. Please check your credentials in site settings.';\n        statusCode = 400;\n      } else if (error.message.includes('Invalid signature')) {\n        errorMessage = 'Invalid Cloudinary API secret. Please check your credentials in site settings.';\n        statusCode = 400;\n      } else if (error.message.includes('Cloud name')) {\n        errorMessage = 'Invalid Cloudinary cloud name. Please check your configuration in site settings.';\n        statusCode = 400;\n      } else if (error.message.includes('Empty file buffer')) {\n        errorMessage = 'The uploaded file is empty or corrupted.';\n        statusCode = 400;\n      } else {\n        errorMessage = `Upload failed: ${error.message}`;\n      }\n    }\n    \n    const response: ApiResponse = {\n      success: false,\n      message: errorMessage\n    };\n    return NextResponse.json(response, { status: statusCode });\n  }\n} catch (outerError) {\n  console.error('âŒ File upload process error:', outerError);\n  \n  const response: ApiResponse = {\n    success: false,\n    message: 'An unexpected error occurred during file upload'\n  };\n  return NextResponse.json(response, { status: 500 });\n}\n}\n\n// Handle URL import\nasync function handleUrlImport(request: NextRequest) {\n  const body = await request.json();\n  const validatedData = validateAndTransform(MediaUrlImportSchema, body);\n\n  try {\n    // Download file from URL\n    const response = await fetch(validatedData.url);\n    if (!response.ok) {\n      const apiResponse: ApiResponse = {\n        success: false,\n        message: 'Failed to download file from URL'\n      };\n      return NextResponse.json(apiResponse, { status: 400 });\n    }\n\n    const contentType = response.headers.get('content-type') || '';\n    const contentLength = parseInt(response.headers.get('content-length') || '0');\n\n    // Validate file size\n    const maxSize = 50 * 1024 * 1024; // 50MB\n    if (contentLength > maxSize) {\n      const apiResponse: ApiResponse = {\n        success: false,\n        message: 'File size exceeds 50MB limit'\n      };\n      return NextResponse.json(apiResponse, { status: 400 });\n    }\n\n    // Determine file type and resource type\n    let fileType = 'other';\n    let resourceType: 'image' | 'video' | 'raw' = 'raw';\n    \n    if (contentType.startsWith('image/')) {\n      fileType = 'image';\n      resourceType = 'image';\n    } else if (contentType.startsWith('video/')) {\n      fileType = 'video';\n      resourceType = 'video';\n    } else if (contentType.startsWith('audio/')) {\n      fileType = 'audio';\n      resourceType = 'raw';\n    }\n\n    // Get file buffer\n    const arrayBuffer = await response.arrayBuffer();\n    const buffer = Buffer.from(arrayBuffer);\n\n    // Upload to Cloudinary\n    const cloudinaryResult = await uploadToCloudinary(buffer, {\n      folder: 'yourcompany/media',\n      resource_type: resourceType,\n    });\n\n    // Extract filename from URL\n    const urlParts = validatedData.url.split('/');\n    const originalFilename = urlParts[urlParts.length - 1] || 'imported-file';\n\n    const tags = validatedData.tags ? JSON.stringify(validatedData.tags) : null;\n\n    // Create media record\n    const mediaData = {\n      filename: originalFilename,\n      title: validatedData.title || originalFilename,\n      description: validatedData.description,\n      alt: validatedData.alt,\n      fileType,\n      mimeType: contentType,\n      fileSize: cloudinaryResult.bytes,\n      width: cloudinaryResult.width,\n      height: cloudinaryResult.height,\n      duration: undefined,\n      originalUrl: validatedData.url,\n      localPath: cloudinaryResult.public_id, // Store Cloudinary public_id\n      publicUrl: cloudinaryResult.secure_url,\n      folderId: validatedData.folderId,\n      tags,\n      uploadSource: 'url_import' as const,\n      isActive: true,\n      isPublic: true\n    };\n\n    const validatedMediaData = validateAndTransform(CreateMediaLibrarySchema, mediaData);\n\n    const mediaItem = await prisma.mediaLibrary.create({\n      data: validatedMediaData,\n      include: {\n        folder: {\n          select: {\n            id: true,\n            name: true,\n            color: true\n          }\n        }\n      }\n    });\n\n    const apiResponse: ApiResponse = {\n      success: true,\n      data: mediaItem,\n      message: 'File imported from URL successfully'\n    };\n\n    return NextResponse.json(apiResponse);\n  } catch (error) {\n    console.error('URL import error:', error);\n    const apiResponse: ApiResponse = {\n      success: false,\n      message: 'Failed to import file from URL'\n    };\n    return NextResponse.json(apiResponse, { status: 500 });\n  }\n}\n\n// PUT - Update media item\nexport async function PUT(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const validatedData = validateAndTransform(UpdateMediaLibrarySchema, body);\n\n    // Check if media item exists\n    const existingItem = await prisma.mediaLibrary.findUnique({\n      where: { id: validatedData.id }\n    });\n\n    if (!existingItem) {\n      const response: ApiResponse = {\n        success: false,\n        message: 'Media item not found'\n      };\n      return NextResponse.json(response, { status: 404 });\n    }\n\n    const { id, ...updateData } = validatedData;\n\n    const mediaItem = await prisma.mediaLibrary.update({\n      where: { id },\n      data: updateData,\n      include: {\n        folder: {\n          select: {\n            id: true,\n            name: true,\n            color: true\n          }\n        },\n        usages: {\n          select: {\n            entityType: true,\n            entityId: true,\n            fieldName: true\n          }\n        }\n      }\n    });\n\n    const response: ApiResponse = {\n      success: true,\n      data: mediaItem,\n      message: 'Media item updated successfully'\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('Failed to update media item:', error);\n    \n    const response: ApiResponse = {\n      success: false,\n      message: error instanceof Error ? error.message : 'Failed to update media item'\n    };\n    \n    const statusCode = error instanceof Error && error.message.includes('Validation failed') ? 400 : 500;\n    return NextResponse.json(response, { status: statusCode });\n  }\n}\n\n// DELETE - Delete media item\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get('id');\n\n    if (!id || isNaN(parseInt(id))) {\n      const response: ApiResponse = {\n        success: false,\n        message: 'Valid media item ID is required'\n      };\n      return NextResponse.json(response, { status: 400 });\n    }\n\n    // Check if media item exists\n    const existingItem = await prisma.mediaLibrary.findUnique({\n      where: { id: parseInt(id) },\n      include: {\n        usages: true\n      }\n    });\n\n    if (!existingItem) {\n      const response: ApiResponse = {\n        success: false,\n        message: 'Media item not found'\n      };\n      return NextResponse.json(response, { status: 404 });\n    }\n\n    // Check if media is being used\n    if (existingItem.usages.length > 0) {\n      const response: ApiResponse = {\n        success: false,\n        message: `Cannot delete media item. It is being used in ${existingItem.usages.length} place(s).`,\n        data: { usages: existingItem.usages }\n      };\n      return NextResponse.json(response, { status: 400 });\n    }\n\n    // Delete from Cloudinary if it's a Cloudinary upload\n    if (existingItem.localPath && !existingItem.localPath.startsWith('/')) {\n      try {\n        await deleteFromCloudinary(existingItem.localPath);\n      } catch (cloudinaryError) {\n        console.error('Failed to delete from Cloudinary:', cloudinaryError);\n        // Continue with database deletion even if Cloudinary deletion fails\n      }\n    }\n\n    // Delete the media item from database\n    await prisma.mediaLibrary.delete({\n      where: { id: parseInt(id) }\n    });\n\n    const response: ApiResponse = {\n      success: true,\n      message: 'Media item deleted successfully'\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('Failed to delete media item:', error);\n    \n    const response: ApiResponse = {\n      success: false,\n      message: 'Failed to delete media item'\n    };\n    return NextResponse.json(response, { status: 500 });\n  }\n} "],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAQA;;;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,0BAA0B;QAC1B,MAAM,aAAa;YACjB,OAAO,aAAa,GAAG,CAAC,YAAY;YACpC,UAAU,aAAa,GAAG,CAAC,eAAe;YAC1C,UAAU,aAAa,GAAG,CAAC,cAAc,SAAS,aAAa,GAAG,CAAC,eAAgB;YACnF,MAAM,aAAa,GAAG,CAAC,SAAS,MAAM,QAAQ;YAC9C,UAAU,aAAa,GAAG,CAAC,cAAc,aAAa,GAAG,CAAC,gBAAgB,SAAS;YACnF,UAAU,aAAa,GAAG,CAAC,cAAc,aAAa,GAAG,CAAC,gBAAgB,SAAS;YACnF,MAAM,SAAS,aAAa,GAAG,CAAC,WAAW;YAC3C,OAAO,SAAS,aAAa,GAAG,CAAC,YAAY;YAC7C,QAAQ,aAAa,GAAG,CAAC,aAAa;YACtC,WAAW,aAAa,GAAG,CAAC,gBAAgB;QAC9C;QAEA,6BAA6B;QAC7B,MAAM,kBAAkB,CAAA,GAAA,2HAAA,CAAA,uBAAoB,AAAD,EAAE,2HAAA,CAAA,oBAAiB,EAAE;QAEhE,qBAAqB;QACrB,MAAM,QAAa,CAAC;QAEpB,IAAI,gBAAgB,KAAK,EAAE;YACzB,MAAM,EAAE,GAAG;gBACT;oBAAE,UAAU;wBAAE,UAAU,gBAAgB,KAAK;wBAAE,MAAM;oBAAc;gBAAE;gBACrE;oBAAE,OAAO;wBAAE,UAAU,gBAAgB,KAAK;wBAAE,MAAM;oBAAc;gBAAE;gBAClE;oBAAE,aAAa;wBAAE,UAAU,gBAAgB,KAAK;wBAAE,MAAM;oBAAc;gBAAE;gBACxE;oBAAE,KAAK;wBAAE,UAAU,gBAAgB,KAAK;wBAAE,MAAM;oBAAc;gBAAE;aACjE;QACH;QAEA,IAAI,gBAAgB,QAAQ,EAAE;YAC5B,MAAM,QAAQ,GAAG,gBAAgB,QAAQ;QAC3C;QAEA,IAAI,gBAAgB,QAAQ,KAAK,WAAW;YAC1C,MAAM,QAAQ,GAAG,gBAAgB,QAAQ;QAC3C;QAEA,IAAI,gBAAgB,QAAQ,KAAK,WAAW;YAC1C,MAAM,QAAQ,GAAG,gBAAgB,QAAQ;QAC3C;QAEA,IAAI,gBAAgB,QAAQ,KAAK,WAAW;YAC1C,MAAM,QAAQ,GAAG,gBAAgB,QAAQ;QAC3C;QAEA,IAAI,gBAAgB,IAAI,IAAI,gBAAgB,IAAI,CAAC,MAAM,GAAG,GAAG;YAC3D,4BAA4B;YAC5B,MAAM,IAAI,GAAG;gBACX,UAAU,KAAK,SAAS,CAAC,gBAAgB,IAAI,CAAC,EAAE;YAClD;QACF;QAEA,uBAAuB;QACvB,MAAM,OAAO,CAAC,CAAC,gBAAgB,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,KAAK,IAAI,EAAE;QAE7E,kBAAkB;QAClB,MAAM,aAAa,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,KAAK,CAAC;YAAE;QAAM;QAE3D,oBAAoB;QACpB,MAAM,aAAa,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,QAAQ,CAAC;YACpD;YACA,SAAS;gBACP,QAAQ;oBACN,QAAQ;wBACN,IAAI;wBACJ,MAAM;wBACN,OAAO;oBACT;gBACF;gBACA,QAAQ;oBACN,QAAQ;wBACN,YAAY;wBACZ,UAAU;wBACV,WAAW;oBACb;gBACF;YACF;YACA,SAAS;gBACP,CAAC,gBAAgB,MAAM,CAAW,EAAE,gBAAgB,SAAS;YAC/D;YACA;YACA,MAAM,gBAAgB,KAAK,IAAI;QACjC;QAEA,4BAA4B;QAC5B,MAAM,aAAa,KAAK,IAAI,CAAC,aAAa,CAAC,gBAAgB,KAAK,IAAI,EAAE;QACtE,MAAM,cAAc,gBAAgB,IAAI,IAAI;QAC5C,MAAM,cAAc,cAAc;QAClC,MAAM,cAAc,cAAc;QAElC,MAAM,WAAwB;YAC5B,SAAS;YACT,MAAM;gBACJ,OAAO;gBACP,YAAY;oBACV,MAAM;oBACN,OAAO,gBAAgB,KAAK,IAAI;oBAChC;oBACA;oBACA;oBACA;gBACF;YACF;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAEhD,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD;QAEA,MAAM,aAAa,iBAAiB,SAAS,MAAM,OAAO,CAAC,QAAQ,CAAC,uBAAuB,MAAM;QACjG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAW;IAC1D;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,QAAQ,GAAG,CAAC;QACZ,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC,mBAAmB;QAC3D,QAAQ,GAAG,CAAC,oBAAoB;QAEhC,IAAI,YAAY,QAAQ,CAAC,wBAAwB;YAC/C,qBAAqB;YACrB,QAAQ,GAAG,CAAC;YACZ,OAAO,iBAAiB;QAC1B,OAAO;YACL,oBAAoB;YACpB,QAAQ,GAAG,CAAC;YACZ,OAAO,gBAAgB;QACzB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAEhD,0CAA0C;QAC1C,IAAI,eAAe;QACnB,IAAI,aAAa;QAEjB,IAAI,iBAAiB,OAAO;YAC1B,eAAe,MAAM,OAAO;YAE5B,8BAA8B;YAC9B,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,iCAAiC;gBAC1D,aAAa;gBACb,eAAe;YACjB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,+BAA+B;gBAC/D,aAAa;gBACb,eAAe;YACjB,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;gBACtD,aAAa;YACf;QACF;QAEA,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS;QACX;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAW;IAC1D;AACF;AAEA,qBAAqB;AACrB,eAAe,iBAAiB,OAAoB;IAClD,IAAI;QACF,QAAQ,GAAG,CAAC;QAEZ,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,QAAQ,GAAG,CAAC,qBAAqB;YAC/B,MAAM,MAAM;YACZ,MAAM,MAAM;YACZ,MAAM,MAAM;YACZ,cAAc,MAAM;QACtB;QAEA,IAAI,CAAC,MAAM;YACT,QAAQ,KAAK,CAAC;YACd,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,gBAAgB;QAChB,MAAM,UAAU,KAAK,OAAO,MAAM,OAAO;QACzC,IAAI,KAAK,IAAI,GAAG,SAAS;YACvB,QAAQ,KAAK,CAAC,8BAA8B,KAAK,IAAI,EAAE;YACvD,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,gBAAgB;QAChB,MAAM,WAAW,KAAK,IAAI;QAC1B,MAAM,WAAW,KAAK,IAAI;QAC1B,MAAM,WAAW,KAAK,IAAI;QAE1B,QAAQ,GAAG,CAAC,oBAAoB;YAC9B;YACA;YACA;YACA;QACF;QAEA,sBAAsB;QACtB,IAAI,WAAW;QACf,IAAI,eAA0C;QAC9C,IAAI,SAAS,UAAU,CAAC,WAAW;YACjC,WAAW;YACX,eAAe;QACjB,OAAO,IAAI,SAAS,UAAU,CAAC,WAAW;YACxC,WAAW;YACX,eAAe;QACjB,OAAO,IAAI,SAAS,UAAU,CAAC,WAAW;YACxC,WAAW;YACX,eAAe;QACjB,OAAO,IAAI,SAAS,QAAQ,CAAC,UAAU,SAAS,QAAQ,CAAC,eAAe,SAAS,QAAQ,CAAC,SAAS;YACjG,WAAW;YACX,eAAe;QACjB;QAEA,QAAQ,GAAG,CAAC,8BAA8B;YACxC;YACA;QACF;QAEF,IAAI;YACF,QAAQ,GAAG,CAAC;YAEZ,uBAAuB;YACvB,MAAM,mBAAmB,MAAM,CAAA,GAAA,0HAAA,CAAA,qBAAkB,AAAD,EAAE,MAAM;gBACtD,QAAQ;gBACR,eAAe;YACjB;YAEA,QAAQ,GAAG,CAAC,mCAAmC;gBAC7C,WAAW,iBAAiB,SAAS;gBACrC,YAAY,iBAAiB,UAAU;gBACvC,OAAO,iBAAiB,KAAK;gBAC7B,OAAO,iBAAiB,KAAK;gBAC7B,QAAQ,iBAAiB,MAAM;YACjC;YAEA,kCAAkC;YAClC,MAAM,QAAQ,SAAS,GAAG,CAAC,UAAU;YACrC,MAAM,cAAc,SAAS,GAAG,CAAC,gBAAgB;YACjD,MAAM,MAAM,SAAS,GAAG,CAAC,QAAQ;YACjC,MAAM,WAAW,SAAS,GAAG,CAAC,cAAc,SAAS,SAAS,GAAG,CAAC,YAAa,QAAQ,MAAM;YAC7F,MAAM,aAAa,SAAS,GAAG,CAAC,SAAS;YACzC,MAAM,OAAO,aAAa,KAAK,SAAS,CAAC,WAAW,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,MAAO,IAAI,IAAI,OAAO;YAEzF,sBAAsB;YACtB,MAAM,YAAY;gBAChB;gBACA,OAAO,SAAS;gBAChB;gBACA;gBACA;gBACA;gBACA,UAAU,iBAAiB,KAAK;gBAChC,OAAO,iBAAiB,KAAK;gBAC7B,QAAQ,iBAAiB,MAAM;gBAC/B,UAAU;gBACV,aAAa,iBAAiB,UAAU;gBACxC,WAAW,iBAAiB,SAAS;gBACrC,WAAW,iBAAiB,UAAU;gBACtC;gBACA;gBACA,cAAc;gBACd,UAAU;gBACV,UAAU;YACZ;YAEA,QAAQ,GAAG,CAAC;YAEZ,MAAM,gBAAgB,CAAA,GAAA,2HAAA,CAAA,uBAAoB,AAAD,EAAE,2HAAA,CAAA,2BAAwB,EAAE;YACrE,QAAQ,GAAG,CAAC;YAEZ,MAAM,YAAY,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,MAAM,CAAC;gBACjD,MAAM;gBACN,SAAS;oBACP,QAAQ;wBACN,QAAQ;4BACN,IAAI;4BACJ,MAAM;4BACN,OAAO;wBACT;oBACF;gBACF;YACF;YAEA,QAAQ,GAAG,CAAC,8BAA8B;gBACxC,IAAI,UAAU,EAAE;gBAChB,UAAU,UAAU,QAAQ;gBAC5B,WAAW,UAAU,SAAS;YAChC;YAEA,MAAM,WAAwB;gBAC5B,SAAS;gBACT,MAAM;gBACN,SAAS;YACX;YAEA,QAAQ,GAAG,CAAC;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAC3B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAE5C,IAAI,eAAe;YACnB,IAAI,aAAa;YAEjB,IAAI,iBAAiB,OAAO;gBAC1B,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,mBAAmB;oBAC5C,eAAe;oBACf,aAAa;gBACf,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,oBAAoB;oBACpD,eAAe;oBACf,aAAa;gBACf,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;oBACtD,eAAe;oBACf,aAAa;gBACf,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,eAAe;oBAC/C,eAAe;oBACf,aAAa;gBACf,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,sBAAsB;oBACtD,eAAe;oBACf,aAAa;gBACf,OAAO;oBACL,eAAe,CAAC,eAAe,EAAE,MAAM,OAAO,EAAE;gBAClD;YACF;YAEA,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAW;QAC1D;IACF,EAAE,OAAO,YAAY;QACnB,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS;QACX;QACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAI;IACnD;AACA;AAEA,oBAAoB;AACpB,eAAe,gBAAgB,OAAoB;IACjD,MAAM,OAAO,MAAM,QAAQ,IAAI;IAC/B,MAAM,gBAAgB,CAAA,GAAA,2HAAA,CAAA,uBAAoB,AAAD,EAAE,2HAAA,CAAA,uBAAoB,EAAE;IAEjE,IAAI;QACF,yBAAyB;QACzB,MAAM,WAAW,MAAM,MAAM,cAAc,GAAG;QAC9C,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,cAA2B;gBAC/B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,aAAa;gBAAE,QAAQ;YAAI;QACtD;QAEA,MAAM,cAAc,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;QAC5D,MAAM,gBAAgB,SAAS,SAAS,OAAO,CAAC,GAAG,CAAC,qBAAqB;QAEzE,qBAAqB;QACrB,MAAM,UAAU,KAAK,OAAO,MAAM,OAAO;QACzC,IAAI,gBAAgB,SAAS;YAC3B,MAAM,cAA2B;gBAC/B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,aAAa;gBAAE,QAAQ;YAAI;QACtD;QAEA,wCAAwC;QACxC,IAAI,WAAW;QACf,IAAI,eAA0C;QAE9C,IAAI,YAAY,UAAU,CAAC,WAAW;YACpC,WAAW;YACX,eAAe;QACjB,OAAO,IAAI,YAAY,UAAU,CAAC,WAAW;YAC3C,WAAW;YACX,eAAe;QACjB,OAAO,IAAI,YAAY,UAAU,CAAC,WAAW;YAC3C,WAAW;YACX,eAAe;QACjB;QAEA,kBAAkB;QAClB,MAAM,cAAc,MAAM,SAAS,WAAW;QAC9C,MAAM,SAAS,OAAO,IAAI,CAAC;QAE3B,uBAAuB;QACvB,MAAM,mBAAmB,MAAM,CAAA,GAAA,0HAAA,CAAA,qBAAkB,AAAD,EAAE,QAAQ;YACxD,QAAQ;YACR,eAAe;QACjB;QAEA,4BAA4B;QAC5B,MAAM,WAAW,cAAc,GAAG,CAAC,KAAK,CAAC;QACzC,MAAM,mBAAmB,QAAQ,CAAC,SAAS,MAAM,GAAG,EAAE,IAAI;QAE1D,MAAM,OAAO,cAAc,IAAI,GAAG,KAAK,SAAS,CAAC,cAAc,IAAI,IAAI;QAEvE,sBAAsB;QACtB,MAAM,YAAY;YAChB,UAAU;YACV,OAAO,cAAc,KAAK,IAAI;YAC9B,aAAa,cAAc,WAAW;YACtC,KAAK,cAAc,GAAG;YACtB;YACA,UAAU;YACV,UAAU,iBAAiB,KAAK;YAChC,OAAO,iBAAiB,KAAK;YAC7B,QAAQ,iBAAiB,MAAM;YAC/B,UAAU;YACV,aAAa,cAAc,GAAG;YAC9B,WAAW,iBAAiB,SAAS;YACrC,WAAW,iBAAiB,UAAU;YACtC,UAAU,cAAc,QAAQ;YAChC;YACA,cAAc;YACd,UAAU;YACV,UAAU;QACZ;QAEA,MAAM,qBAAqB,CAAA,GAAA,2HAAA,CAAA,uBAAoB,AAAD,EAAE,2HAAA,CAAA,2BAAwB,EAAE;QAE1E,MAAM,YAAY,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YACjD,MAAM;YACN,SAAS;gBACP,QAAQ;oBACN,QAAQ;wBACN,IAAI;wBACJ,MAAM;wBACN,OAAO;oBACT;gBACF;YACF;QACF;QAEA,MAAM,cAA2B;YAC/B,SAAS;YACT,MAAM;YACN,SAAS;QACX;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,MAAM,cAA2B;YAC/B,SAAS;YACT,SAAS;QACX;QACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,aAAa;YAAE,QAAQ;QAAI;IACtD;AACF;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,CAAA,GAAA,2HAAA,CAAA,uBAAoB,AAAD,EAAE,2HAAA,CAAA,2BAAwB,EAAE;QAErE,6BAA6B;QAC7B,MAAM,eAAe,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,UAAU,CAAC;YACxD,OAAO;gBAAE,IAAI,cAAc,EAAE;YAAC;QAChC;QAEA,IAAI,CAAC,cAAc;YACjB,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,MAAM,EAAE,EAAE,EAAE,GAAG,YAAY,GAAG;QAE9B,MAAM,YAAY,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YACjD,OAAO;gBAAE;YAAG;YACZ,MAAM;YACN,SAAS;gBACP,QAAQ;oBACN,QAAQ;wBACN,IAAI;wBACJ,MAAM;wBACN,OAAO;oBACT;gBACF;gBACA,QAAQ;oBACN,QAAQ;wBACN,YAAY;wBACZ,UAAU;wBACV,WAAW;oBACb;gBACF;YACF;QACF;QAEA,MAAM,WAAwB;YAC5B,SAAS;YACT,MAAM;YACN,SAAS;QACX;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD;QAEA,MAAM,aAAa,iBAAiB,SAAS,MAAM,OAAO,CAAC,QAAQ,CAAC,uBAAuB,MAAM;QACjG,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAW;IAC1D;AACF;AAGO,eAAe,OAAO,OAAoB;IAC/C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,KAAK,aAAa,GAAG,CAAC;QAE5B,IAAI,CAAC,MAAM,MAAM,SAAS,MAAM;YAC9B,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,6BAA6B;QAC7B,MAAM,eAAe,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,UAAU,CAAC;YACxD,OAAO;gBAAE,IAAI,SAAS;YAAI;YAC1B,SAAS;gBACP,QAAQ;YACV;QACF;QAEA,IAAI,CAAC,cAAc;YACjB,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS;YACX;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,+BAA+B;QAC/B,IAAI,aAAa,MAAM,CAAC,MAAM,GAAG,GAAG;YAClC,MAAM,WAAwB;gBAC5B,SAAS;gBACT,SAAS,CAAC,8CAA8C,EAAE,aAAa,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC;gBAChG,MAAM;oBAAE,QAAQ,aAAa,MAAM;gBAAC;YACtC;YACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;gBAAE,QAAQ;YAAI;QACnD;QAEA,qDAAqD;QACrD,IAAI,aAAa,SAAS,IAAI,CAAC,aAAa,SAAS,CAAC,UAAU,CAAC,MAAM;YACrE,IAAI;gBACF,MAAM,CAAA,GAAA,0HAAA,CAAA,uBAAoB,AAAD,EAAE,aAAa,SAAS;YACnD,EAAE,OAAO,iBAAiB;gBACxB,QAAQ,KAAK,CAAC,qCAAqC;YACnD,oEAAoE;YACtE;QACF;QAEA,sCAAsC;QACtC,MAAM,kHAAA,CAAA,SAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YAC/B,OAAO;gBAAE,IAAI,SAAS;YAAI;QAC5B;QAEA,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS;QACX;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,MAAM,WAAwB;YAC5B,SAAS;YACT,SAAS;QACX;QACA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAI;IACnD;AACF","debugId":null}}]
}